(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["main"],{"235d":function(t,e,s){"use strict";var i=s("52fa"),a=s.n(i);a.a},"386d":function(t,e,s){"use strict";var i=s("cb7c"),a=s("83a1"),n=s("5f1b");s("214f")("search",1,function(t,e,s,r){return[function(s){var i=t(this),a=void 0==s?void 0:s[e];return void 0!==a?a.call(s,i):new RegExp(s)[e](String(i))},function(t){var e=r(s,t,this);if(e.done)return e.value;var c=i(t),o=String(this),l=c.lastIndex;a(l,0)||(c.lastIndex=0);var u=n(c,o);return a(c.lastIndex,l)||(c.lastIndex=l),null===u?-1:u.index}]})},4454:function(t,e,s){t.exports=s.p+"assets/img/kefu.c023d355.jpg"},"4ffd":function(t,e,s){t.exports=s.p+"assets/img/logo.e1d63897.png"},"52fa":function(t,e,s){},"7f7f":function(t,e,s){var i=s("86cc").f,a=Function.prototype,n=/^\s*function ([^ (]*)/,r="name";r in a||s("9e1e")&&i(a,r,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},"7f94":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"main"},[i("el-container",[i("el-header",{staticClass:"centered"},[i("div",{staticClass:"head"},[i("div",{staticClass:"pull-left"},[i("img",{attrs:{src:s("4ffd"),alt:""}}),i("span",{staticClass:"text"},[t._v("泰斗医聊客服系统")])]),i("div",{staticClass:"pull-right"},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:s("4454"),alt:""}})]),i("el-dropdown",[i("span",{staticClass:"el-dropdown-link"},[t._v("\n                "+t._s(t.info.username)+"\n                "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{divided:"","split-button":""}},[i("el-tooltip",{attrs:{content:"退出登录",placement:"bottom",effect:"light"}},[i("div",{staticClass:"iconCenter",staticStyle:{"text-align":"center"},on:{click:function(e){return t.headClick(3)}}},[i("i",{staticClass:"icon iconfont icon-tuichu"})])])],1)],1)],1)],1)])]),i("el-container",[i("el-aside",{staticClass:"left",attrs:{width:"500px"}},[i("div",{staticClass:"ul_left"},[i("ul",{staticClass:"wechat-list"},t._l(t.wechatList,function(e,s){return i("li",{key:s,staticClass:"item",class:{wechatActive:t.wechatActive===e.id},on:{click:function(s){return t.openList(e)}}},[i("div",{staticClass:"photo"},[i("img",{attrs:{src:e.img,alt:""}})]),i("el-badge",{attrs:{value:3}},[i("div",{staticClass:"name",attrs:{title:e.name}},[t._v(t._s(e.name))])])],1)}),0)]),i("div",{staticClass:"ul_right"},[i("div",{staticClass:"name centered"},[t._v(t._s(t.title))]),i("div",{staticClass:"input-search"},[i("el-input",{attrs:{placeholder:"昵称/备注","prefix-icon":"el-icon-search"},on:{change:t.searchChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"}],staticClass:"search"},[i("ul",{staticClass:"search-list"},[t.isSearchShow?i("li",{staticClass:"isSearch centered"},[t._v("无数据")]):t._l(t.userList,function(e,s){return i("li",{key:s,staticClass:"item",on:{click:function(s){return t.searchClick(e)}}},[i("div",{staticClass:"photo"},[i("img",{attrs:{src:e.avatar,alt:""}})]),i("div",{staticClass:"name"},[t._v(t._s(e.nickname))])])})],2)]),i("ul",{staticClass:"one-list"},t._l(t.groupList,function(e,s){return i("li",{key:s,staticClass:"one-item cursor"},[i("div",{staticClass:"title",on:{click:function(s){return t.OneChange(e)}}},[i("div",{staticClass:"text"},[t._v(t._s(e.group_name)+"（"+t._s(e.person_num)+"个）")]),i("div",{staticClass:"ioc"},[i("i",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"item.status"}],staticClass:"el-icon-arrow-down"}),i("i",{directives:[{name:"show",rawName:"v-show",value:!e.status,expression:"!item.status"}],staticClass:"el-icon-arrow-right"})])]),i("el-collapse-transition",[i("ul",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"item.status"}],staticClass:"two-list"},t._l(e.userList,function(e,s){return i("li",{key:s,staticClass:"two-item",class:{bgActive:t.bgActive===e.id},on:{click:function(s){return t.chatChange(e)}}},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:e.headimgurl}})]),i("div",{staticClass:"nickname"},[t._v(t._s(e.nickname))])])}),0)])],1)}),0)])]),i("el-main",[t.devShow?i("div",{staticClass:"main-contens"},[i("div",{staticClass:"nickname centered"},[t._v(t._s(t.userData.nickname))]),i("div",{staticClass:"dialogue-k"},[i("ul",{staticClass:"list"},t._l(t.chatList,function(e,s){return i("li",{key:s,staticClass:"item"},[1===e.stype?i("div",{staticClass:"tourist"},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:e.sendAvatar,alt:""}})]),i("div",{staticClass:"centens"},[i("div",{staticClass:"time"},[t._v(t._s(e.create_at))]),1===e.msgType?i("div",{staticClass:"text"},[t._v(t._s(e.msgData.content))]):t._e(),2===e.msgType?i("div",{staticClass:"pull-left",staticStyle:{width:"200px"}},[i("img",{attrs:{src:e.msgData.picUrl,alt:""}})]):t._e()])]):t._e(),2===e.stype?i("div",{staticClass:"hospital-guide"},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:e.sendAvatar,alt:""}})]),i("div",{staticClass:"centens"},[i("div",{staticClass:"time"},[t._v(t._s(e.create_at))]),1===e.msgType?i("div",{staticClass:"text"},[t._v(t._s(e.msgData.content))]):t._e(),2===e.msgType?i("div",{staticClass:"pull-right",staticStyle:{width:"300px"}},[e.msgData.picWidth>300?i("img",{staticStyle:{width:"100%"},attrs:{src:e.msgData.picUrl,alt:""}}):i("img",{staticStyle:{width:"auto"},attrs:{src:e.msgData.picUrl,alt:""}})]):t._e()])]):t._e()])}),0)]),i("div",{staticClass:"footer"},[i("div",{staticClass:"toolbar"},[i("ul",{staticClass:"list"},[i("li",{staticClass:"pull-left cursor file"},[i("el-upload",{attrs:{"list-type":"picture-card",action:t.uploadUrl,onSuccess:t.uploadSuccess,"before-upload":t.beforeUpload,"show-file-list":!1}},[i("i",{staticClass:"icon iconfont icon-wenjianjia"})])],1),i("li",{staticClass:"pull-left cursor"},[i("i",{staticClass:"el-icon-picture",staticStyle:{"font-size":"24px"}})]),i("li",{staticClass:"pull-left cursor"},[i("i",{staticClass:"icon iconfont icon-liaotian"})])])]),i("div",{staticClass:"input-text"},[i("el-input",{staticClass:"textarea",attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.formParams.content,callback:function(e){t.$set(t.formParams,"content",e)},expression:"formParams.content"}})],1),i("div",{staticClass:"btn"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}}},[t._v("发 送")])],1)])]):t._e()]),i("el-aside",{staticClass:"right",attrs:{width:"400px"}},[i("div",{staticClass:"right-aside"},[i("div",{staticClass:"right-aside-top"},[i("ul",{staticClass:"list"},[i("li",{staticClass:"item",class:{active:1===t.rightActive},on:{click:function(e){t.rightActive=1}}},[t._v("快捷回复")]),i("li",{staticClass:"item",class:{active:2===t.rightActive},on:{click:function(e){t.rightActive=2}}},[t._v("客户资料")]),i("li",{staticClass:"item",class:{active:4===t.rightActive},on:{click:function(e){t.rightActive=4}}},[t._v("病症信息")])])]),i("div",{staticClass:"right-middle-contens"},[i("div",{directives:[{name:"show",rawName:"v-show",value:1===t.rightActive,expression:"rightActive === 1"}],staticClass:"reply"},[t._v("快捷回复")]),i("div",{directives:[{name:"show",rawName:"v-show",value:2===t.rightActive,expression:"rightActive === 2"}],staticClass:"remark"},[t._v("用户信息")]),i("div",{directives:[{name:"show",rawName:"v-show",value:4===t.rightActive,expression:"rightActive === 4"}],staticClass:"disease"},[t._v("病症信息")])])])])],1)],1)],1),i("el-dialog",{attrs:{title:"发送图片",visible:t.imageShow},on:{"update:visible":function(e){t.imageShow=e}}},[i("div",{staticClass:"image",staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:t.imageUrl,alt:""}})]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.imageShow=!1}}},[t._v("返 回")]),i("el-button",{attrs:{type:"primary"},on:{click:t.imageChange}},[t._v("确 定")])],1)])],1)},a=[],n=(s("386d"),s("a481"),s("ac6a"),s("7f7f"),s("96cf"),s("3b8d")),r=s("2f62"),c=s("1c1e");function o(){return Object(c["a"])({url:"/v1/wechat/index/wechat_list",method:"GET"})}function l(t){return Object(c["a"])({url:"v1/wechat/index/wechat_group?weid="+t,method:"GET"})}function u(t){return Object(c["a"])({url:"v1/wechat/index/my_friend_list?weid="+t.weid+"&groupid="+t.groupid,method:"GET"})}function h(t){return Object(c["a"])({url:"v1/wechat/send_msg",method:"POST",data:t})}var d={data:function(){return{info:[],formLabelWidth:"100px",dialogWidth:"30%",socketData:{user_type:"yz",query_type:"head_data",user_id:""},formParams:{weid:"",fans_openid:"",msg_type:"",content:"",source_type:"",file:""},unread:0,userData:"",devShow:!1,cacheData:{cache_content:"",id:"",groupid:""},rightActive:1,keyword:"",userList:[],searchShow:!1,isSearchShow:!1,title:"",wechatList:[],wechatActive:"",bgActive:"",groupList:[],friendList:[],weid:"",params:{weid:"",groupid:""},chatList:[],imageUrl:"",imageWidth:0,imageHeight:0,imageShow:!1,baseURL:"https://tdcsgzh.wuhanlst.com",uploadUrl:""}},mounted:function(){this.getWechatList(),this.WebSocketTest()},computed:Object(r["c"])({token:function(t){return t.token},device:function(t){return t.device},unReadNum:function(){return this.unread>99?"99+":this.unread}}),methods:{headClick:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(3!==e){t.next=5;break}return t.next=3,signOut();case 3:s=t.sent,200==s.code&&(this.$router.push("/"),sessionStorage.clear(),window.location.reload());case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getWechatList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:e=t.sent,200===e.code&&(this.wechatList=e.data.wechat,this.weid=e.data.wechat[0].id,this.params.weid=this.weid,this.formParams.weid=this.weid,this.title=this.weid=e.data.wechat[0].name,this.getGroup(),console.log(this.uploadUrl));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getGroup:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l(this.weid);case 2:e=t.sent,200===e.code&&(this.groupList=e.data.group_info,this.groupList.forEach(function(t){t.status=!1,s.params.groupid=t.groupid,u(s.params).then(function(e){200===e.code&&(t.userList=e.data.friend_list,t.userList.forEach(function(t){t.content=""}))})}),console.log(this.groupList));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),openList:function(t){this.wechatActive=t.id,this.weid=t.id,this.params.weid=this.weid,this.formParams.weid=this.weid,this.title=t.name,this.getGroup()},chatChange:function(t){var e=this;this.formParams.fans_openid=t.fans_openid,this.uploadUrl=this.baseURL+"/v1/wechat/send_msg?token="+this.token+"&device="+this.device+"&weid="+this.formParams.weid+"&fans_openid="+this.formParams.fans_openid,this.cacheData.content=this.formParams.content,this.cacheData.groupid&&this.groupList.forEach(function(t){t.groupid===e.cacheData.groupid&&t.userList.forEach(function(t){t.id===e.cacheData.id&&(t.content=e.cacheData.content)})}),this.formParams.content=t.content,this.bgActive=t.id,this.userData=t,this.devShow=!0,this.cacheData.id=t.id,this.cacheData.groupid=t.groupid},OneChange:function(t){t.status=!t.status,this.$forceUpdate()},send:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h(this.formParams);case 2:e=t.sent,200===e.code&&(console.log(e),1===this.formParams.msg_type&&(this.formParams.content=""));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),submit:function(){""!==this.formParams.content?(this.formParams.content=this.formParams.content.replace(/\n/,""),this.formParams.msg_type=1,this.send()):this.$message({message:"请输入内容",type:"warning"})},beforeUpload:function(t){},uploadSuccess:function(t,e,s){console.log(e),console.log(e.raw),this.formParams.file=e.raw,console.log(this.formParams.file),this.formParams.msg_type=2,this.formParams.source_type=1,this.send()},imageChange:function(){this.formParams.msg_type=2,this.formParams.source_type=1,this.send()},searchChange:function(){var t=this;this.userList=[],""===this.keyword?this.searchShow=!1:(this.groupList.forEach(function(e){e.userList.forEach(function(e){-1!=e.nickname.search(t.keyword)&&t.userList.push({avatar:e.headimgurl,nickname:e.nickname})})}),""==this.userList?(this.searchShow=!0,this.isSearchShow=!0):(this.searchShow=!0,this.isSearchShow=!1))},scrollChange:function(){setTimeout(function(){var t=document.querySelector(".dialogue-k > .list"),e=document.querySelector(".dialogue-k");setTimeout(function(){e.scrollHeight-110<=t.scrollHeight&&(e.scrollTop=t.scrollHeight)},50)},200)},WebSocketTest:function(){var t=new WebSocket("ws://tdcsgzh.wuhanlst.com:11111?token="+this.token+"&device="+this.device);t.onopen=function(){},t.onmessage=function(t){JSON.parse(t.data)},t.onclose=function(){}}}},m=d,f=(s("235d"),s("2877")),p=Object(f["a"])(m,i,a,!1,null,"1533d9ef",null);e["default"]=p.exports},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},ac6a:function(t,e,s){for(var i=s("cadf"),a=s("0d58"),n=s("2aba"),r=s("7726"),c=s("32e9"),o=s("84f2"),l=s("2b4c"),u=l("iterator"),h=l("toStringTag"),d=o.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=a(m),p=0;p<f.length;p++){var v,g=f[p],w=m[g],C=r[g],_=C&&C.prototype;if(_&&(_[u]||c(_,u,d),_[h]||c(_,h,g),o[g]=d,w))for(v in i)_[v]||n(_,v,i[v],!0)}}}]);