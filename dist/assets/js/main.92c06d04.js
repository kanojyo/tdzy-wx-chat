(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["main"],{"11e9":function(t,e,i){var a=i("52a7"),s=i("4630"),n=i("6821"),r=i("6a99"),c=i("69a8"),o=i("c69a"),l=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?l:function(t,e){if(t=n(t),e=r(e,!0),o)try{return l(t,e)}catch(i){}if(c(t,e))return s(!a.f.call(t,e),t[e])}},"386d":function(t,e,i){"use strict";var a=i("cb7c"),s=i("83a1"),n=i("5f1b");i("214f")("search",1,function(t,e,i,r){return[function(i){var a=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,a):new RegExp(i)[e](String(a))},function(t){var e=r(i,t,this);if(e.done)return e.value;var c=a(t),o=String(this),l=c.lastIndex;s(l,0)||(c.lastIndex=0);var u=n(c,o);return s(c.lastIndex,l)||(c.lastIndex=l),null===u?-1:u.index}]})},"3b2b":function(t,e,i){var a=i("7726"),s=i("5dbc"),n=i("86cc").f,r=i("9093").f,c=i("aae3"),o=i("0bfb"),l=a.RegExp,u=l,h=l.prototype,d=/a/g,p=/a/g,f=new l(d)!==d;if(i("9e1e")&&(!f||i("79e5")(function(){return p[i("2b4c")("match")]=!1,l(d)!=d||l(p)==p||"/a/i"!=l(d,"i")}))){l=function(t,e){var i=this instanceof l,a=c(t),n=void 0===e;return!i&&a&&t.constructor===l&&n?t:s(f?new u(a&&!n?t.source:t,e):u((a=t instanceof l)?t.source:t,a&&n?o.call(t):e),i?this:h,l)};for(var m=function(t){t in l||n(l,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},v=r(u),g=0;v.length>g;)m(v[g++]);h.constructor=l,l.prototype=h,i("2aba")(a,"RegExp",l)}i("7a56")("RegExp")},4454:function(t,e,i){t.exports=i.p+"assets/img/kefu.c023d355.jpg"},"4ffd":function(t,e,i){t.exports=i.p+"assets/img/logo.e1d63897.png"},"5dbc":function(t,e,i){var a=i("d3f4"),s=i("8b97").set;t.exports=function(t,e,i){var n,r=e.constructor;return r!==i&&"function"==typeof r&&(n=r.prototype)!==i.prototype&&a(n)&&s&&s(t,n),t}},"7f7f":function(t,e,i){var a=i("86cc").f,s=Function.prototype,n=/^\s*function ([^ (]*)/,r="name";r in s||i("9e1e")&&a(s,r,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},"7f94":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"main"},[a("el-container",[a("el-header",{staticClass:"centered"},[a("div",{staticClass:"head"},[a("div",{staticClass:"pull-left"},[a("img",{attrs:{src:i("4ffd"),alt:""}}),a("span",{staticClass:"text"},[t._v("泰斗医聊客服系统")])]),a("div",{staticClass:"pull-right"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:i("4454"),alt:""}})]),a("el-dropdown",[a("span",{staticClass:"el-dropdown-link"},[t._v("\n                "+t._s(t.info.username)+"\n                "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{divided:"","split-button":""}},[a("el-tooltip",{attrs:{content:"退出登录",placement:"bottom",effect:"light"}},[a("div",{staticClass:"iconCenter",staticStyle:{"text-align":"center"},on:{click:function(e){return t.headClick(3)}}},[a("i",{staticClass:"icon iconfont icon-tuichu"})])])],1)],1)],1)],1)])]),a("el-container",[a("el-aside",{staticClass:"left",attrs:{width:"500px"}},[a("div",{staticClass:"ul_left"},[a("ul",{staticClass:"wechat-list"},t._l(t.wechatList,function(e,i){return a("li",{key:i,staticClass:"item",class:{wechatActive:t.wechatActive===e.id},on:{click:function(i){return t.openList(e)}}},[a("div",{staticClass:"photo"},[a("img",{attrs:{src:e.img,alt:""}})]),a("div",{staticClass:"text"},[a("div",{staticClass:"name",attrs:{title:e.name}},[t._v(t._s(e.name))]),a("span",{directives:[{name:"show",rawName:"v-show",value:0!==e.not_read_num,expression:"item.not_read_num !== 0"}],staticClass:"number"},[t._v(t._s(e.not_read_num))])])])}),0)]),a("div",{staticClass:"ul_right"},[a("div",{staticClass:"name centered"},[t._v(t._s(t.title))]),a("div",{staticClass:"input-search"},[a("el-input",{attrs:{placeholder:"昵称/备注","prefix-icon":"el-icon-search"},on:{change:t.searchChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.searchShow,expression:"searchShow"}],staticClass:"search"},[a("ul",{staticClass:"search-list"},[t.isSearchShow?a("li",{staticClass:"isSearch centered"},[t._v("无数据")]):t._l(t.userList,function(e,i){return a("li",{key:i,staticClass:"item",on:{click:function(i){return t.searchClick(e)}}},[a("div",{staticClass:"photo"},[a("img",{attrs:{src:e.avatar,alt:""}})]),a("div",{staticClass:"name"},[t._v(t._s(e.nickname))])])})],2)]),a("ul",{staticClass:"one-list"},t._l(t.groupList,function(e,i){return a("li",{key:i,staticClass:"one-item cursor"},[a("div",{staticClass:"title",on:{click:function(i){return t.OneChange(e)}}},[a("div",{staticClass:"text"},[t._v(t._s(e.group_name)+"（"+t._s(e.count)+"个）")]),a("div",{staticClass:"ioc"},[a("i",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"item.status"}],staticClass:"el-icon-arrow-down"}),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.status,expression:"!item.status"}],staticClass:"el-icon-arrow-right"})])]),a("el-collapse-transition",[a("ul",{directives:[{name:"show",rawName:"v-show",value:e.status,expression:"item.status"}],staticClass:"two-list"},t._l(e.userList,function(e,i){return a("li",{key:i,staticClass:"two-item",class:{bgActive:t.bgActive===e.id},on:{click:function(i){return t.chatChange(e)}}},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.headimgurl}})]),a("div",{staticClass:"nickname"},[t._v(t._s(e.nickname))])])}),0)])],1)}),0)])]),a("el-main",[t.devShow?a("div",{staticClass:"main-contens"},[a("div",{staticClass:"nickname centered"},[t._v(t._s(t.userData.nickname))]),a("div",{staticClass:"dialogue-k"},[a("ul",{staticClass:"list"},t._l(t.chatList,function(e,i){return a("li",{key:i,staticClass:"item"},[1===e.key?a("div",{staticClass:"system"},[a("div",{staticClass:"text"},[t._v(t._s(e.content))])]):t._e(),0===e.key?a("div",{staticClass:"info"},[1===e.send_type?a("div",{staticClass:"tourist"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.fans_avatar,alt:""}})]),a("div",{staticClass:"centens"},[a("div",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.ctime)))]),1===e.msg_type?a("div",{staticClass:"text"},[t._v(t._s(e.content))]):t._e(),2===e.msg_type?a("div",{staticClass:"pull-left",staticStyle:{width:"200px"}},[a("img",{attrs:{src:e.picurl,alt:""}})]):t._e()])]):t._e(),2===e.send_type?a("div",{staticClass:"hospital-guide"},[a("div",{staticClass:"avatar"},[a("img",{attrs:{src:e.kf_avatar,alt:""}})]),a("div",{staticClass:"centens"},[a("div",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.ctime)))]),1===e.msg_type?a("div",{staticClass:"text"},[t._v(t._s(e.content))]):t._e(),2===e.msg_type?a("div",{staticClass:"pull-right",staticStyle:{width:"300px"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:e.picurl,alt:""}})]):t._e()])]):t._e()]):t._e()])}),0)]),a("div",{staticClass:"footer"},[a("div",{staticClass:"toolbar"},[a("ul",{staticClass:"list"},[a("li",{staticClass:"pull-left cursor file"},[a("el-upload",{attrs:{"list-type":"picture-card",action:t.uploadUrl,onSuccess:t.uploadSuccess,"show-file-list":!1}},[a("i",{staticClass:"icon iconfont icon-wenjianjia"})])],1),a("li",{staticClass:"pull-left cursor"},[a("i",{staticClass:"el-icon-picture",staticStyle:{"font-size":"24px"}})]),a("li",{staticClass:"pull-left cursor"},[a("i",{staticClass:"icon iconfont icon-liaotian"})])])]),a("div",{staticClass:"input-text"},[a("el-input",{staticClass:"textarea",attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.formParams.content,callback:function(e){t.$set(t.formParams,"content",e)},expression:"formParams.content"}})],1),a("div",{staticClass:"btn"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}}},[t._v("发 送")])],1)])]):t._e()]),a("el-aside",{staticClass:"right",attrs:{width:"400px"}},[a("div",{staticClass:"right-aside"},[a("div",{staticClass:"right-aside-top"},[a("ul",{staticClass:"list"},[a("li",{staticClass:"item",class:{active:1===t.rightActive},on:{click:function(e){t.rightActive=1}}},[t._v("快捷回复")]),a("li",{staticClass:"item",class:{active:2===t.rightActive},on:{click:function(e){t.rightActive=2}}},[t._v("客户资料")]),a("li",{staticClass:"item",class:{active:4===t.rightActive},on:{click:function(e){t.rightActive=4}}},[t._v("病症信息")])])]),a("div",{staticClass:"right-middle-contens"},[a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.rightActive,expression:"rightActive === 1"}],staticClass:"reply"},[t._v("快捷回复")]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.rightActive,expression:"rightActive === 2"}],staticClass:"remark"},[t._v("用户信息")]),a("div",{directives:[{name:"show",rawName:"v-show",value:4===t.rightActive,expression:"rightActive === 4"}],staticClass:"disease"},[t._v("病症信息")])])])])],1)],1)],1),a("el-dialog",{attrs:{title:"发送图片",visible:t.imageShow,width:"30%"},on:{"update:visible":function(e){t.imageShow=e}}},[a("div",{staticClass:"image",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:t.imageUrl,alt:""}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.imageShow=!1}}},[t._v("返 回")]),a("el-button",{attrs:{type:"primary"},on:{click:t.imageChange}},[t._v("确 定")])],1)])],1)},s=[],n=(i("386d"),i("a481"),i("bd86")),r=(i("ac6a"),i("7f7f"),i("96cf"),i("3b8d")),c=i("2f62"),o=i("1c1e");function l(){return Object(o["a"])({url:"/v1/wechat/index/wechat_list",method:"GET"})}function u(t){return Object(o["a"])({url:"/v1/wechat/index/wechat_group?weid="+t,method:"GET"})}function h(t){return Object(o["a"])({url:"/v1/wechat/index/my_friend_list?weid="+t.weid+"&groupid="+t.groupid,method:"GET"})}function d(t){return Object(o["a"])({url:"/v1/wechat/send_msg",method:"POST",data:t})}function p(t){return Object(o["a"])({url:"/v1/wechat/index/chat_list?fans_openid="+t.fans_openid+"&page_index="+t.page_index+"&page_size="+t.page_size,method:"GET",data:t})}function f(t){return Object(o["a"])({url:"/v1/wechat/send_image_wechat",method:"POST",data:t})}i("3b2b");function m(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var a in i)if(new RegExp("(".concat(a,")")).test(e)){var s=i[a]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?s:v(s))}return e}function v(t){return("00"+t).substr(t.length)}var g={data:function(){return{info:[],formLabelWidth:"100px",dialogWidth:"30%",socketData:{user_type:"yz",query_type:"head_data",user_id:""},formParams:{weid:"",fans_openid:"",msg_type:"",content:"",source_type:"",file:""},picParams:{weid:"",fans_openid:"",source_type:1,url:""},userData:"",devShow:!1,cacheData:{cache_content:"",id:"",groupid:""},rightActive:1,keyword:"",userList:[],searchShow:!1,isSearchShow:!1,title:"",wechatList:[],wechatActive:"",bgActive:"",groupList:[],friendList:[],weid:"",params:{weid:"",groupid:""},chatParams:{fans_openid:"",page_index:"",page_size:""},chatList:[],imageUrl:"",imageWidth:0,imageHeight:0,imageShow:!1,baseURL:"https://tdcsgzh.wuhanlst.com",uploadUrl:"",avatar:"https://cdn-statis.mangguokandian.com/avatar.png"}},filters:{formatDate:function(t){var e=new Date(1e3*t);return m(e,"MM-dd hh:mm")}},mounted:function(){this.getWechatList(),this.WebSocketTest(),this.uploadUrl=this.baseURL+"/v1/uploads"},computed:Object(c["c"])({token:function(t){return t.token},device:function(t){return t.device}}),methods:{headClick:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(3!==e){t.next=5;break}return t.next=3,signOut();case 3:i=t.sent,200==i.code&&(this.$router.push("/"),sessionStorage.clear(),window.location.reload());case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getWechatList:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:e=t.sent,200===e.code&&(this.wechatList=e.data.wechat,this.weid=e.data.wechat[0].id,this.params.weid=this.weid,this.formParams.weid=this.weid,this.picParams.weid=this.weid,this.title=e.data.wechat[0].name,this.getGroup());case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getGroup:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u(this.weid);case 2:e=t.sent,200===e.code&&(this.groupList=e.data.group_info,this.groupList.forEach(function(t){t.status=!1,i.params.groupid=t.groupid,h(i.params).then(function(e){200===e.code&&(t.userList=e.data.friend_list,t.userList.forEach(function(t){t.content=""}))})}));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),openList:function(t){this.wechatActive=t.id,this.weid=t.id,this.params.weid=this.weid,this.formParams.weid=this.weid,this.picParams.weid=this.weid,this.title=t.name,this.getGroup()},getChatList:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p(this.chatParams);case 2:e=t.sent,200===e.code&&(this.chatList=e.data.data,console.log(this.chatList));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),chatChange:function(t){var e=this;this.formParams.fans_openid=t.fans_openid,this.picParams.fans_openid=t.fans_openid,this.chatParams.fans_openid=t.fans_openid,this.cacheData.content=this.formParams.content,this.cacheData.groupid&&this.groupList.forEach(function(t){t.groupid===e.cacheData.groupid&&t.userList.forEach(function(t){t.id===e.cacheData.id&&(t.content=e.cacheData.content)})}),this.formParams.content=t.content,this.bgActive=t.id,this.userData=t,this.cacheData.id=t.id,this.cacheData.groupid=t.groupid,this.devShow=!0,this.getChatList()},OneChange:function(t){t.status=!t.status,this.$forceUpdate()},send:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,i,a,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d(this.formParams);case 2:e=t.sent,200===e.code&&(console.log(e),a=e.data,s={},this.formParams.content="",i={content:a.content,msg_type:a.msg_type,ctime:a.ctime,key:0,send_type:2},Object(n["a"])(i,"msg_type",1),Object(n["a"])(i,"kf_avatar",this.avatar),s=i,this.chatList.push(s));case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),submit:function(){""!==this.formParams.content?(this.formParams.content=this.formParams.content.replace(/\n/,""),this.formParams.msg_type=1,this.send()):this.$message({message:"请输入内容",type:"warning"})},uploadSuccess:function(t){200==t.code&&(console.log(t.data.url),this.imageUrl=t.data.url,this.imageShow=!0)},imageChange:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,i,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.picParams.url=this.imageUrl,t.next=3,f(this.picParams);case 3:e=t.sent,200===e.code&&(console.log(e),i=e.data,a={picurl:i.picurl,msg_type:i.msg_type,ctime:i.ctime,key:0,send_type:2,kf_avatar:this.avatar},this.chatList.push(a),this.imageUrl="",this.imageShow=!1);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),searchChange:function(){var t=this;this.userList=[],""===this.keyword?this.searchShow=!1:(this.groupList.forEach(function(e){e.userList.forEach(function(e){-1!=e.nickname.search(t.keyword)&&t.userList.push({avatar:e.headimgurl,nickname:e.nickname,groupid:e.groupid,id:e.id})})}),""==this.userList?(this.searchShow=!0,this.isSearchShow=!0):(this.searchShow=!0,this.isSearchShow=!1))},searchClick:function(t){var e=this,i=t;this.groupList.forEach(function(t){t.groupid===i.groupid&&(t.status=!0,t.userList.forEach(function(t){t.id===i.id&&(e.chatChange(t),e.searchShow=!1,e.isSearchShow=!1)}))})},scrollChange:function(){setTimeout(function(){var t=document.querySelector(".dialogue-k > .list"),e=document.querySelector(".dialogue-k");setTimeout(function(){e.scrollHeight-110<=t.scrollHeight&&(e.scrollTop=t.scrollHeight)},50)},200)},WebSocketTest:function(){var t=this,e=new WebSocket("ws://tdcsgzh.wuhanlst.com:11111?token="+this.token+"&device="+this.device);e.onopen=function(){},e.onmessage=function(e){var i;if(i=-1!=e.data.indexOf("{")?JSON.parse(e.data):e.data,200===i.code){var a=i.data;t.formParams.fans_openid===a.fans_openid?(console.log(t.formParams.fans_openid===a.fans_openid),t.chatList.push(a)):console.log(222)}},e.onclose=function(){}}}},w=g,_=(i("acf4"),i("2877")),C=Object(_["a"])(w,a,s,!1,null,"61c403ac",null);e["default"]=C.exports},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"8b97":function(t,e,i){var a=i("d3f4"),s=i("cb7c"),n=function(t,e){if(s(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,a){try{a=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),e=!(t instanceof Array)}catch(s){e=!0}return function(t,i){return n(t,i),e?t.__proto__=i:a(t,i),t}}({},!1):void 0),check:n}},9093:function(t,e,i){var a=i("ce10"),s=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,s)}},ac6a:function(t,e,i){for(var a=i("cadf"),s=i("0d58"),n=i("2aba"),r=i("7726"),c=i("32e9"),o=i("84f2"),l=i("2b4c"),u=l("iterator"),h=l("toStringTag"),d=o.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(p),m=0;m<f.length;m++){var v,g=f[m],w=p[g],_=r[g],C=_&&_.prototype;if(C&&(C[u]||c(C,u,d),C[h]||c(C,h,g),o[g]=d,w))for(v in a)C[v]||n(C,v,a[v],!0)}},acf4:function(t,e,i){"use strict";var a=i("c038"),s=i.n(a);s.a},c038:function(t,e,i){}}]);